{{#if newNodeNewFile}}  {{!UPLOAD NEW FILE SECTION - NEW OSF USERS}}
    {{dropzone-widget
        url=url
        options=dropzoneOptions
        sending=(action 'sending')
        buildUrl=(action 'getUrl')
        complete=(action 'complete')
        preUpload=(action 'preUpload')
        defaultMessage=(t 'components.file-uploader.dropzone_message')
        maxfilesexceeded=(action 'maxfilesexceeded')
    }}
    {{#if hasFile}}
        {{preprint-title-editor nodeTitle=nodeTitle titleValid=titleValid}}
    {{/if}}

    <div class="p-t-xs pull-right">
        <button class="btn btn-default" {{action changeInitialState startState}}>Back</button>
        <button class="btn btn-primary" disabled={{or (and (eq convertOrCopy 'convert') (not convertProjectConfirmed))(not (and (not uploadInProgress)(and hasFile titleValid)))}} {{action 'setNodeAndFile'}}>{{t "submit.body.save_continue"}}</button>
    </div>
{{else}}
    {{#preprint-form-section class="upload-section-block" allowOpen=true name='uploadNewFile' open=false}}  {{!UPLOAD NEW FILE SECTION}}
        {{preprint-form-header name=(if (or fileLocked nodeLocked) 'preprint_file' 'choose_file') selectedFile=osfFile fileVersion=fileVersion file=file showValidationIndicator=false}}
        {{#preprint-form-body}}
            {{#if fileLocked}}
                <div class="alert alert-danger m-v-sm" role="alert">
                    {{if isTopLevelNode (t "components.file-uploader.otherPreprintsProjectFileWarning") (t "components.file-uploader.otherPreprintsComponentFileWarning")}}
                </div>
            {{/if}}
            {{#if (or fileLocked nodeLocked)}}
                <p class='text-muted m-v-sm text-smaller'> {{t "components.file-uploader.update_version"}}</p>
            {{else}}
                <div class="m-t-sm">
                    <form class="form">
                        <div class="toggle-button">
                            <input id='existing' onchange={{action changeExistingState _existingState.NEWFILE}} type="radio" checked={{eq existingState _existingState.NEWFILE}}>
                            <label for="existing"><i class="fa fa-cloud-upload"></i></label>

                            <input id='newfile' onchange={{action changeExistingState _existingState.EXISTINGFILE}} type="radio" checked={{eq existingState _existingState.EXISTINGFILE}}>
                            <label for="newfile"><i class="fa fa-th-list"></i></label>
                        </div>
                    </form>
                </div>
            {{/if}}
            {{dropzone-widget
                url=url
                options=dropzoneOptions
                sending=(action 'sending')
                buildUrl=(action 'getUrl')
                complete=(action 'complete')
                preUpload=(action 'preUpload')
                defaultMessage=(t 'components.file-uploader.dropzone_message')
                maxfilesexceeded=(action 'maxfilesexceeded')
            }}
        {{/preprint-form-body}}
    {{/preprint-form-section}}

    {{#if (and selectedNode (or hasFile osfFile)) use='crossFade'}}
        {{#if (or fileLocked nodeLocked)}}
            {{#preprint-form-section class="upload-section-block bottom-title-underline" allowOpen=true name='titleOfPreprint' open=false}} {{!EDIT MODE - UPDATE TITLE/SAVE CHANGES SECTION OR FILELOCKED-ADD MODE}}
                {{preprint-form-header nodeTitle=nodeTitle name='title_of_preprint' showValidationIndicator=false}}
                {{#preprint-form-body}}
                    {{#if fileLocked}}
                        <div class="alert alert-danger m-v-sm" role="alert">
                            {{if isTopLevelNode (t "components.file-uploader.otherPreprintsProjectTitleWarning") (t "components.file-uploader.otherPreprintsComponentTitleWarning")}}
                        </div>
                    {{/if}}
                    <label class="text-muted title-label text-smaller">  {{if isTopLevelNode (t "components.preprint-form-project-select.edit_preprint_title_project") (t "components.preprint-form-project-select.edit_preprint_title_component")}} </label>
                    {{preprint-title-editor nodeTitle=nodeTitle titleValid=titleValid}}
                {{/preprint-form-body}}
            {{/preprint-form-section}}
            <div class="m-v-md text-center">
                {{#if (and fileLocked (not nodeLocked))}}
                    <p> {{t "components.preprint-form-project-select.initiate_preprint_process_file_locked"}} </p>
                {{else}}
                    <p>{{t "components.preprint-form-project-select.edit_organize_section"}}  </p>
                {{/if}}
                <button {{action "discardUploadChanges"}} class="btn btn-default" disabled={{unless uploadChanged true}} >{{t "global.discard"}}</button>
                <button class="btn btn-primary" disabled={{not (and hasFile titleValid)}} {{action 'uploadFileToExistingNode'}}>Save and continue</button>
            </div>
        {{else}}
            {{#preprint-form-section class="upload-section-block" allowOpen=true name='organize' open=false}} {{!ORGANIZE DECISION SECTION}}
                {{preprint-form-header name='organize' isTopLevelNode=isTopLevelNode convertOrCopy=convertOrCopy showValidationIndicator=false}}
                {{#preprint-form-body}}
                    {{convert-or-copy-project nextUploadSection=nextUploadSection clearDownstreamFields=clearDownstreamFields isTopLevelNode=isTopLevelNode convertOrCopy=convertOrCopy nodeTitle=nodeTitle node=node titleValid=titleValid convertProjectConfirmed=convertProjectConfirmed}}
                {{/preprint-form-body}}
            {{/preprint-form-section}}
            {{#if (or (eq convertOrCopy 'copy') (and (eq convertOrCopy 'convert') convertProjectConfirmed)) use='crossFade'}}
                {{#preprint-form-section class="upload-section-block" allowOpen=true name='finalizeUpload' open=false}} {{!FINALIZE UPLOAD SECTION - NEW FILE}}
                    {{preprint-form-header name='finalize_upload' nodeTitle=nodeTitle showValidationIndicator=false}}
                    {{#preprint-form-body}}
                        {{#if (eq convertOrCopy 'convert')}}
                            {{#if convertProjectConfirmed}}
                                <label class="text-muted title-label text-smaller"> {{if isTopLevelNode (t "components.preprint-form-project-select.edit_preprint_title_project") (t "components.preprint-form-project-select.edit_preprint_title_component")}} </label>
                            {{/if}}
                        {{/if}}
                        {{preprint-title-editor nodeTitle=nodeTitle titleValid=titleValid}}
                        <div class="row text-center m-v-md">
                            <p> {{t "components.preprint-form-project-select.initiate_preprint_process"}} </p>
                            <button class="btn btn-primary" disabled={{or (and (eq convertOrCopy 'convert') (not convertProjectConfirmed))(not (and (not uploadInProgress)(and hasFile titleValid)))}} {{action 'setNodeAndFile'}}>Save and continue</button>
                        </div>
                    {{/preprint-form-body}}
                {{/preprint-form-section}}
            {{/if}}
        {{/if}}
    {{/if}}
{{/if}}
